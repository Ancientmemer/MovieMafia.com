<!DOCTYPE html>
<html>
<head><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Movie Mafia</title><link rel="stylesheet" href="styles.css"></head>
<body>
<button onclick="logout()">Logout</button>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
  const supabase = supabase.createClient(
    'https://rinvgyegukgickkusfzk.supabase.co',
    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJpbnZneWVndWtnaWNra3VzZnprIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ1NDQ5NzMsImV4cCI6MjA2MDEyMDk3M30.XShV5jBBsEx-ynt9-HON6zfW1qiXwtGm0QwnmvqTjlg'
  );
  async function logout() {
  const { error } = await supabase.auth.signOut();
  if (!error) {
    window.location.href = 'login.html';
  } else {
    alert('Logout failed: ' + error.message);
  }
  }

  async function fetchUsername() {
    const { data: { user } } = await supabase.auth.getUser();

    if (user) {
      const { data, error } = await supabase
        .from('profiles')
        .select('username')
        .eq('id', user.id)
        .single();

      if (!error && data) {
        document.getElementById('welcomeMessage').textContent = `Welcome, ${data.username}!`;
      }
    } else {
      // If no user is logged in, redirect to login page
      window.location.href = 'login.html';
    }
  }

  fetchUsername();
</script>
<marquee>Movie Mafia</marquee>
<img src="assets/moviemafia.jpg" alt="Movie Mafia Poster" width="100%" height="50%">
</body>
</html>
